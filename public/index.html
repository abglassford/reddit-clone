<!DOCTYPE html>
<html ng-app="greenit">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/css/materialize.min.css">
    <link rel="stylesheet" href="./src/style.css" media="screen" title="no title">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"rel="stylesheet">
    <title>Greenit</title>
  </head>
  <body>
    <header>
      <div class="header container rotate">
        <div class="row">
          <div class="logoDiv col m3 s12">
            <h1 class="logo">Greenit</h1>
          </div>
          <div class="postDiv col m3 s12" ng-controller="showNewController as new">
            <h2 class="post" ng-click="new.newPost()"><a href="#"><i class="add rotate material-icons">add</i> Submit Post</a></h2>
          </div>
          <div class="order col m3 s12">
            <div class="sortDiv input-field" ng-controller="sortArticlesController as sort">
              <select ng-model="sort.selection" class="sortBy" ng-change="sort.sort()">
                <option value="-votes">Votes</option>
                <option value="-date">Date</option>
                <option value="title">Title</option>
              </select>
            </div>
          </div>
          <div class="searchDiv input-field col m3 s12" ng-controller="searchArticlesController as search">
            <input ng-model="search.searchText" class="search" type="text" name="name" placeholder="Search" ng-change="search.search()">
          </div>
        </div>
      </div>
    </header>
    <main>
      <div class="main container" ng-controller="subgreenitController as sub">
        <div class="row" ng-show="showPost">
          <div class="newPost card-panel yellow black-text col m12">
            <h1>New Posting</h1>
            <form name="sub.postInfo" novalidate ng-submit="sub.addPost()">
              <div class="input-field col m4">
                <label for="title">Title</label>
                <input ng-model="sub.newPostData.title"type="text" name="title" ng-class="{ invalid : postInfo.title.$invalid && !postInfo.title.$pristine}" required>
              </div>
              <div class="input-field col m4">
                <label for="author">Author</label>
                <input ng-model="sub.newPostData.author"type="text" name="author" ng-class="{ invalid : postInfo.author.$invalid && !postInfo.author.$pristine}"required>
              </div>
              <div class="input-field col m4">
                <label for="image">Image</label>
                <input ng-model="sub.newPostData.image" type="text" name="image" ng-class="{ invalid : postInfo.image.$invalid && !postInfo.image.$pristine}"required>
              </div>
              <div class="input-field col m12">
                <label for="content">Content</label>
                <input ng-model="sub.newPostData.description" type="text" name="content" ng-class="{ invalid : postInfo.content.$invalid && !postInfo.content.$pristine}" required>
              </div>
              <div class="col m2 offset-m5">
                <input class="waves-effect waves-light btn"type="submit" name="submit" value="Submit" ng-disabled="postInfo.$invalid">
              </div>
              <div class="row">
              </div>
            </form>
          </div>
        </div>
        <div class="row">
          <br>
          <div class="subgreenit card-panel teal white-text" ng-repeat="post in sub.postArray | filter : searchText | orderBy : selection">
            <div class="postDiv row">
              <div class="photoDiv col m4">
                <img class="photo"src={{post.image}} alt="image">
              </div>
              <div class="col m8">
                <h4>{{post.title}}</h4>
                <h4>by {{post.author}} <a class="waves-effect waves-light" ng-click="sub.downVote(post)">
                  <i class="material-icons rotate">remove</i>
                </a>
                <span ng-class="{'positive' : post.votes >  0, 'negative' : post.votes < 0}">{{post.votes}}</span>
                <a class="waves-effect waves-light" ng-click="sub.upVote(post)">
                  <i class="material-icons">add</i>
                </a>
                </h4>
                <p>{{post.description}}</p>
              </div>
              <div class="row">
                <div class="col m3 offset-m2">
                  <a ng-click="sub.showComments(post)">
                    <i class="material-icons">comment</i> {{post.commentList.length}} <ng-pluralize count="post.commentList.length" when="{
                      '0' : 'comments',
                      'one' : 'comment',
                      'other' : 'comments'
                    }"></ng-pluralize>
                  </a>
                </div>
                <div class="col m3">
                  <a ng-click="sub.showCommentForm(post)">
                    <i class="material-icons">mode_edit</i>
                     add comment
                  </a>
                </div>
                <div class="time col m3">
                  <time>{{post.date | amCalendar}}</time>
                </div>
              </div>
            </div>
            <div class="card-panel yellow black-text row" ng-show="post.commentFormView">
              <form name="newComment" ng-submit="sub.addComment(post)">
                <div class="input-field col m6">
                  <label for="author">Author</label>
                  <input ng-model="sub.commentData.author"type="text" name="author">
                  <label for="author">Author</label>
                </div>
                <div class="input-field col m6">
                  <label for="content">Content</label>
                  <input ng-model="sub.commentData.content"type="text" name="content">
                </div>
                <div class="col m2 offset-m5">
                  <input class="waves-effect waves-light btn"type="submit" name="submit" value="Submit" ng-disabled="newComment.$invalid">
                </div>
              </form>
            </div>
            <div class="card-panel yellow black-text fade" ng-repeat="comment in post.commentList" ng-show="post.commentView">
              <h4>{{comment.author}}</h3>
              <p>{{comment.content}}</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>


    <script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/js/materialize.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.6/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.0-rc.2/angular-animate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular-moment/0.9.0/angular-moment.min.js"></script>
    <script src="./src/app.js"></script>
    <script src="./src/controllers.js"></script>
    <script src="./src/angular-animate.js"></script>
  </body>
</html>
